const _0x1e3b4c=_0x158a;function _0x158a(_0x5b7774,_0x5ee0ed){const _0x365bd1=_0x365b();return _0x158a=function(_0x158a79,_0x4a8e4c){_0x158a79=_0x158a79-0xcd;let _0x5647c0=_0x365bd1[_0x158a79];return _0x5647c0;},_0x158a(_0x5b7774,_0x5ee0ed);}function _0x365b(){const _0x7c7008=['3617511vNrKrr','Link','./config.yml','VqzxV','ticketClose','emit','TranscriptType','viewTranscriptButton','4NbXaXQ','dashboard','RPvzn','url','setEmoji','checkDashboard','ticketCloseTitle','4504068OHuOry','7KHPdLc','>\x0a>\x20','TicketSettings','avatar','setLabel','../models/dashboardModel','437755RuJllb','closeUserID','../models/reviewsModel','Red','findOne','8FHqZwI','appendFile','js-yaml','log','addComponents','username','ClaimingSystem','/transcript?channelId=','get','cache','channelID','17353171ZooVdx','HTnXk','Locale','messages','Enabled','GuildID','ticketClaimedBy','readFileSync','setStyle','setColor','catch','ButtonEmojis','MessagesRequirement',']\x20[TICKET\x20CLOSED]\x20A\x20ticket\x20has\x20been\x20successfully\x20closed','870546pwIXhe','ButtonColors','ChannelID','CloseTicketButton','user','closeTicket','ticketType','channels','channel','reply','No\x20reason\x20provided.','wXFOw','files','TicketTranscriptSettings','1307526FKoTsi','10PGAKIy','fetch','customId','send','https://cdn.discordapp.com/avatars/','\x0a\x0a[','addFields','624175ppYqvY','utf8','claimUser','setTimestamp','edit','reason','components'];_0x365b=function(){return _0x7c7008;};return _0x365b();}(function(_0x10946d,_0x3800f7){const _0x4a0032=_0x158a,_0x117d99=_0x10946d();while(!![]){try{const _0x7eb1c9=parseInt(_0x4a0032(0x105))/0x1+-parseInt(_0x4a0032(0xfd))/0x2+-parseInt(_0x4a0032(0x10c))/0x3+parseInt(_0x4a0032(0x114))/0x4*(-parseInt(_0x4a0032(0xd1))/0x5)+-parseInt(_0x4a0032(0xef))/0x6*(parseInt(_0x4a0032(0x11c))/0x7)+-parseInt(_0x4a0032(0xd6))/0x8*(-parseInt(_0x4a0032(0x11b))/0x9)+parseInt(_0x4a0032(0xfe))/0xa*(parseInt(_0x4a0032(0xe1))/0xb);if(_0x7eb1c9===_0x3800f7)break;else _0x117d99['push'](_0x117d99['shift']());}catch(_0xbbfb89){_0x117d99['push'](_0x117d99['shift']());}}}(_0x365b,0x94e9a));const {Discord,ActionRowBuilder,ButtonBuilder,EmbedBuilder,StringSelectMenuBuilder,Message,MessageAttachment,ModalBuilder,TextInputBuilder}=require('discord.js'),fs=require('fs'),yaml=require(_0x1e3b4c(0xd8)),config=yaml['load'](fs[_0x1e3b4c(0xe8)](_0x1e3b4c(0x10e),_0x1e3b4c(0x106))),utils=require('../utils.js'),guildModel=require('../models/guildModel'),ticketModel=require('../models/ticketModel'),reviewsModel=require(_0x1e3b4c(0xd3)),dashboardModel=require(_0x1e3b4c(0xd0));module['exports']=async(_0x10caf8,_0x5c0deb)=>{const _0x55b844=_0x1e3b4c,_0x31223d=await guildModel['findOne']({'guildID':config[_0x55b844(0xe6)]}),_0x78654a=await ticketModel[_0x55b844(0xd5)]({'channelID':_0x5c0deb['channel']['id']}),_0x231734=await dashboardModel['findOne']({'guildID':config['GuildID']});async function _0x192a58(){const _0x168b5a=_0x55b844,{attachment:_0x380368,timestamp:_0x5e88e9}=await utils['saveTranscript'](_0x5c0deb);let _0x35ea4b=await _0x10caf8['users']['cache'][_0x168b5a(0xde)](_0x78654a['userID']),_0x326505=await _0x10caf8['users']['cache'][_0x168b5a(0xde)](_0x78654a[_0x168b5a(0xd2)]),_0x4f9b91=_0x78654a['closeReason']||_0x168b5a(0xf9),_0x1dfa47=await _0x10caf8['users'][_0x168b5a(0xdf)][_0x168b5a(0xde)](_0x78654a[_0x168b5a(0x107)]),_0x361a99=_0x78654a[_0x168b5a(0xe4)];const _0x1b026e=new EmbedBuilder();_0x1b026e[_0x168b5a(0xea)]('Red'),_0x1b026e['setTitle'](config[_0x168b5a(0xe3)][_0x168b5a(0x11a)]);if(_0x326505)_0x1b026e['addFields']([{'name':'•\x20'+config[_0x168b5a(0xe3)]['logsClosedBy'],'value':'>\x20<@!'+_0x326505['id']+'>\x0a>\x20'+_0x326505['username']}]);_0x1b026e['addFields']([{'name':'•\x20'+config['Locale']['logsTicketAuthor'],'value':'>\x20<@!'+_0x35ea4b['id']+'>\x0a>\x20'+_0x35ea4b['username']}]);if(config[_0x168b5a(0xcd)]['TicketCloseReason']&&_0x4f9b91)_0x1b026e[_0x168b5a(0x104)]([{'name':'•\x20'+config[_0x168b5a(0xe3)][_0x168b5a(0x10a)],'value':'>\x20'+_0x4f9b91}]);if(_0x1dfa47&&config[_0x168b5a(0xdc)]['Enabled'])_0x1b026e[_0x168b5a(0x104)]([{'name':'•\x20'+config['Locale'][_0x168b5a(0xe7)],'value':'>\x20<@!'+_0x1dfa47['id']+_0x168b5a(0x11d)+_0x1dfa47[_0x168b5a(0xdb)]}]);_0x1b026e['addFields']([{'name':'•\x20'+config[_0x168b5a(0xe3)]['logsTicket'],'value':'>\x20#'+_0x5c0deb[_0x168b5a(0xf7)]['name']+'\x0a>\x20'+_0x78654a[_0x168b5a(0xf5)]}]),_0x1b026e[_0x168b5a(0x108)](),_0x1b026e['setThumbnail'](_0x168b5a(0x102)+_0x5c0deb[_0x168b5a(0xf3)]['id']+'/'+_0x5c0deb[_0x168b5a(0xf3)]['avatar']+'.webp?size=240'),_0x1b026e['setFooter']({'text':config['Locale']['totalMessagesLog']+'\x20'+_0x361a99,'iconURL':_0x168b5a(0x102)+_0x5c0deb['user']['id']+'/'+_0x5c0deb['user'][_0x168b5a(0xce)]+'.webp?size=240'});let _0x4ea7c9,_0x25a621;if(!config['ticketClose']['ChannelID'])_0x25a621=_0x5c0deb['guild'][_0x168b5a(0xf6)][_0x168b5a(0xdf)][_0x168b5a(0xde)](config[_0x168b5a(0xcd)]['LogsChannelID']);if(config[_0x168b5a(0x110)]['ChannelID'])_0x25a621=_0x5c0deb['guild']['channels']['cache']['get'](config[_0x168b5a(0x110)][_0x168b5a(0xf1)]);const _0x1b131e=await utils[_0x168b5a(0x119)]();if(_0x25a621&&config['ticketClose'][_0x168b5a(0xe5)]){if(_0x168b5a(0x10f)!=='kZrur'){const _0x56c63a={'embeds':[_0x1b026e]},_0x5d44a0=_0x361a99>=config['TicketTranscriptSettings']['MessagesRequirement']&&!_0x1b131e;if(_0x5d44a0){if(_0x168b5a(0xe2)!=='FHnTq')_0x56c63a[_0x168b5a(0xfb)]=[_0x380368];else{if(_0x357f90)_0x14b936[_0x168b5a(0xd9)](_0x3c6e56);}}if(_0x1b131e&&_0x361a99>=config['TicketTranscriptSettings'][_0x168b5a(0xed)]&&config[_0x168b5a(0xfc)][_0x168b5a(0x112)]==='HTML'&&config[_0x168b5a(0xfc)]['SaveInFolder']===!![]){const _0x56e075=new ButtonBuilder()[_0x168b5a(0xcf)](config['Locale'][_0x168b5a(0x113)])['setStyle'](_0x168b5a(0x10d))['setURL'](_0x231734['url']+_0x168b5a(0xdd)+_0x78654a[_0x168b5a(0xe0)]+'&dateNow='+_0x5e88e9),_0x242279=new ActionRowBuilder()[_0x168b5a(0xda)](_0x56e075);_0x56c63a[_0x168b5a(0x10b)]=[_0x242279];}await _0x25a621[_0x168b5a(0x101)](_0x56c63a)['then'](async function(_0x32ea46){_0x4ea7c9=_0x32ea46['id'];});}else _0x43f7f1['files']=[_0x1a92d2];}_0x10caf8[_0x168b5a(0x111)]('sendUserDM',_0x78654a,_0x380368,_0x4ea7c9,_0x5e88e9);let _0x5d4126=config['TicketSettings']['DeleteTime']*0x3e8,_0x397c85=config[_0x168b5a(0xe3)]['deletingTicketMsg']['replace'](/{time}/g,''+config['TicketSettings']['DeleteTime']);const _0x5c6716=new EmbedBuilder()['setDescription'](_0x397c85)['setColor'](_0x168b5a(0xd4)),_0x75bb57=new ButtonBuilder()['setCustomId']('closeTicket')[_0x168b5a(0xcf)](config[_0x168b5a(0xe3)][_0x168b5a(0xf2)])[_0x168b5a(0xe9)](config[_0x168b5a(0xf0)][_0x168b5a(0xf4)])[_0x168b5a(0x118)](config[_0x168b5a(0xec)]['closeTicket'])['setDisabled'](!![]);let _0x444be2=new ActionRowBuilder()[_0x168b5a(0xda)](_0x75bb57);await _0x5c0deb['channel']['messages'][_0x168b5a(0xff)](_0x78654a['msgID'])['then'](_0x426e9f=>{const _0x4c5c34=_0x168b5a;_0x4c5c34(0xfa)==='ImFfR'?_0x5b6044[_0x4c5c34(0x109)]({'components':[_0x593396]}):_0x426e9f['edit']({'components':[_0x444be2]});});if(!_0x5c0deb[_0x168b5a(0x115)]){if(_0x5c0deb[_0x168b5a(0x100)]==='closeReason')await _0x5c0deb[_0x168b5a(0xf8)]({'embeds':[_0x5c6716]});else{if('eDDSw'===_0x168b5a(0x116)){const _0x4be4c9=new _0x420322()[_0x168b5a(0xcf)](_0x235289['Locale'][_0x168b5a(0x113)])['setStyle']('Link')['setURL'](_0x2d6686[_0x168b5a(0x117)]+'/transcript?channelId='+_0x35afa5[_0x168b5a(0xe0)]+'&dateNow='+_0x51ae1f),_0x4e653b=new _0x20cb85()['addComponents'](_0x4be4c9);_0xc94701['components']=[_0x4e653b];}else await _0x5c0deb['followUp']({'embeds':[_0x5c6716]});}}else _0x5c0deb['dashboard']&&await _0x5c0deb['channel'][_0x168b5a(0x101)]({'embeds':[_0x5c6716]});setTimeout(async()=>{const _0x260033=_0x168b5a;await _0x5c0deb['channel']['delete']()[_0x260033(0xeb)](_0x334c0d=>{});},_0x5d4126);let _0x3d8fd8=_0x168b5a(0x103)+new Date()['toLocaleString']()+_0x168b5a(0xee);fs[_0x168b5a(0xd7)]('./logs.txt',_0x3d8fd8,_0xef67eb=>{if(_0xef67eb)console['log'](_0xef67eb);});}_0x192a58();};
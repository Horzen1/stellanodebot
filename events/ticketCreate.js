const _0x36be89=_0x9cb5;function _0x1993(){const _0x3a6dc9=['.\x20Contact\x20support\x20and\x20provide\x20your\x20config.yml\x20file.','setFooter','Schedule','findOne','guilds','EIgQe','SendNoticeInTicket','send','616pXgrCl','exports','dddd','Button\x20config\x20not\x20found\x20for\x20key:\x20','addFields','<t:','cache','messages','isValid','{endTime-','GuildID','896634nFiREe','42455YWvSuU','setColor','hasOwnProperty','IMAPl','readFileSync','utf8','TicketOverload','notAnswered','questions','guildID','match','2991879MGcrgR','Yellow','pyfba','WorkingHours','Enabled','Number\x20of\x20questions\x20mismatch.','length','Red','outsideWorkingHoursMsg',':t>','setTitle','format','some','save','[ERROR]\x20Invalid\x20working\x20hours\x20configuration\x20for\x20','2SmILKE','\x20(format).\x20Contact\x20support\x20and\x20provide\x20your\x20config.yml\x20file.','13793300hDttdU','Threshold','from','username','qiaDH','Button\x20values\x20in\x20the\x20database\x20do\x20not\x20match\x20the\x20configuration.','11lppAzQ','response','openTickets','setTimestamp','setDescription','```','load','[ERROR]\x20Working\x20hours\x20not\x20configured\x20for\x20','CXAiy','get','user','95ePeqVz','\x1b[31m%s\x1b[0m','channelID','YYYY-MM-DD','5192055euwxCA','find','reduce','YYYY-MM-DD\x20H:mm','question','Questions','channels','fetch','log','moment-timezone','Timezone','102908xXmwiJ','png','isBetween','Open','115424yBfXNi','displayAvatarURL'];_0x1993=function(){return _0x3a6dc9;};return _0x1993();}(function(_0x25b21f,_0x599c5c){const _0x5510ed=_0x9cb5,_0x2cf61f=_0x25b21f();while(!![]){try{const _0x198987=parseInt(_0x5510ed(0x101))/0x1*(-parseInt(_0x5510ed(0xcd))/0x2)+parseInt(_0x5510ed(0xf2))/0x3+parseInt(_0x5510ed(0xd1))/0x4*(-parseInt(_0x5510ed(0x114))/0x5)+-parseInt(_0x5510ed(0xe6))/0x6+-parseInt(_0x5510ed(0xe7))/0x7*(parseInt(_0x5510ed(0xdb))/0x8)+-parseInt(_0x5510ed(0xc2))/0x9+-parseInt(_0x5510ed(0x103))/0xa*(-parseInt(_0x5510ed(0x109))/0xb);if(_0x198987===_0x599c5c)break;else _0x2cf61f['push'](_0x2cf61f['shift']());}catch(_0x16bfa8){_0x2cf61f['push'](_0x2cf61f['shift']());}}}(_0x1993,0x81e90));const {Discord,StringSelectMenuBuilder,EmbedBuilder,ActionRowBuilder,TextInputBuilder,ModalBuilder}=require('discord.js'),fs=require('fs'),yaml=require('js-yaml'),config=yaml[_0x36be89(0x10f)](fs[_0x36be89(0xeb)]('./config.yml',_0x36be89(0xec))),guildModel=require('../models/guildModel'),ticketModel=require('../models/ticketModel'),moment=require(_0x36be89(0xcb));function _0x9cb5(_0x12b01d,_0x56809b){const _0x199386=_0x1993();return _0x9cb5=function(_0x9cb53b,_0x3578ce){_0x9cb53b=_0x9cb53b-0xbf;let _0x5eb4d8=_0x199386[_0x9cb53b];return _0x5eb4d8;},_0x9cb5(_0x12b01d,_0x56809b);}module[_0x36be89(0xdc)]=async(_0x3f42ea,_0x5d22d8,_0x16e4c0,_0x1461eb)=>{const _0x5f3834=_0x36be89,_0x2934f4=await ticketModel['findOne']({'channelID':_0x16e4c0['id']}),_0x5bffe9=await guildModel[_0x5f3834(0xd6)]({'guildID':config['GuildID']});_0x5bffe9['totalTickets']++,await _0x5bffe9[_0x5f3834(0xff)]();const _0x846cc7=await ticketModel['countDocuments']({'status':_0x5f3834(0xd0),'guildID':config[_0x5f3834(0xe5)]});_0x5bffe9['openTickets']!==_0x846cc7&&(_0x5f3834(0xea)!=='IMAPl'?_0x4efe30['log'](_0x5f3834(0xbf),'[ERROR]\x20Invalid\x20working\x20hours\x20configuration\x20for\x20'+_0x38531f+'\x20(format).\x20Contact\x20support\x20and\x20provide\x20your\x20config.yml\x20file.'):(_0x5bffe9[_0x5f3834(0x10b)]=_0x846cc7,await _0x5bffe9[_0x5f3834(0xff)]()));if(config[_0x5f3834(0xed)]&&config[_0x5f3834(0xed)][_0x5f3834(0xf6)]){if(_0x5f3834(0x111)!=='mrzgc'){const _0xd6d959=config['TicketOverload']['Threshold'];if(_0x846cc7>=_0xd6d959){const _0x4d2b9a=config[_0x5f3834(0xed)]['WarningMessage'],_0x4f3e4c=new EmbedBuilder()['setColor'](_0x5f3834(0xf3))['setDescription'](_0x4d2b9a)[_0x5f3834(0xd4)]({'text':_0x5d22d8[_0x5f3834(0x113)][_0x5f3834(0x106)],'iconURL':_0x5d22d8['user'][_0x5f3834(0xd2)]({'format':_0x5f3834(0xce),'dynamic':!![],'size':0x400})})['setTimestamp'](),_0x37a420=_0x3f42ea[_0x5f3834(0xd7)]['cache']['get'](_0x2934f4[_0x5f3834(0xf0)])[_0x5f3834(0xc8)]['cache']['get'](_0x2934f4[_0x5f3834(0xc0)]);_0x37a420&&_0x37a420[_0x5f3834(0xda)]({'embeds':[_0x4f3e4c]});}}else{const _0x1bb175=_0x1bb848[_0x5f3834(0xed)][_0x5f3834(0x104)];if(_0x3330f1>=_0x1bb175){const _0x1c50a1=_0x3d713b[_0x5f3834(0xed)]['WarningMessage'],_0xc9c7bd=new _0x2a3b0e()['setColor'](_0x5f3834(0xf3))[_0x5f3834(0x10d)](_0x1c50a1)[_0x5f3834(0xd4)]({'text':_0x28c108['user']['username'],'iconURL':_0x2f1541['user'][_0x5f3834(0xd2)]({'format':'png','dynamic':!![],'size':0x400})})[_0x5f3834(0x10c)](),_0x42163c=_0x3d4be5['guilds']['cache'][_0x5f3834(0x112)](_0x5ddf09[_0x5f3834(0xf0)])['channels'][_0x5f3834(0xe1)]['get'](_0x4effa7['channelID']);_0x42163c&&_0x42163c['send']({'embeds':[_0xc9c7bd]});}}}if(_0x2934f4){if('UQOaB'==='UQOaB'){const _0x50823e=_0x3f42ea['guilds']['cache']['get'](_0x2934f4['guildID'])[_0x5f3834(0xc8)][_0x5f3834(0xe1)]['get'](_0x2934f4[_0x5f3834(0xc0)]);if(config[_0x5f3834(0xf5)]&&config[_0x5f3834(0xf5)]['Enabled']&&config[_0x5f3834(0xf5)]['AllowTicketsOutsideWorkingHours']&&config[_0x5f3834(0xf5)][_0x5f3834(0xd9)]){if('ywLhZ'!=='IJWBZ'){const _0x257cf8=/^(\d{1,2}:\d{2})-(\d{1,2}:\d{2})$/,_0x7ca04c=moment()['tz'](config['WorkingHours']['Timezone'])[_0x5f3834(0xfd)](_0x5f3834(0xdd)),_0x4dfa9e=config['WorkingHours']['Schedule'][_0x7ca04c];if(!_0x4dfa9e){console[_0x5f3834(0xca)](_0x5f3834(0xbf),_0x5f3834(0x110)+_0x7ca04c+'.\x20Contact\x20support\x20and\x20provide\x20your\x20config.yml\x20file.');return;}const _0x25a838=_0x4dfa9e['match'](_0x257cf8);if(!_0x25a838){console['log']('\x1b[31m%s\x1b[0m',_0x5f3834(0x100)+_0x7ca04c+'\x20(format).\x20Contact\x20support\x20and\x20provide\x20your\x20config.yml\x20file.');return;}const _0x402fd6=moment()['tz'](config['WorkingHours'][_0x5f3834(0xcc)]),_0xb07584=_0x402fd6[_0x5f3834(0xfd)](_0x5f3834(0xc1)),_0x1152dd=moment['tz'](_0xb07584+'\x20'+_0x25a838[0x1],'YYYY-MM-DD\x20H:mm',config[_0x5f3834(0xf5)][_0x5f3834(0xcc)]),_0x3c224b=moment['tz'](_0xb07584+'\x20'+_0x25a838[0x2],_0x5f3834(0xc5),config['WorkingHours']['Timezone']);if(!_0x1152dd['isValid']()||!_0x3c224b[_0x5f3834(0xe3)]()||_0x1152dd['isSameOrAfter'](_0x3c224b)){console[_0x5f3834(0xca)]('\x1b[31m%s\x1b[0m','[ERROR]\x20Invalid\x20working\x20hours\x20configuration\x20for\x20'+_0x7ca04c+_0x5f3834(0xd3));return;}const _0x4e9138=_0x402fd6[_0x5f3834(0xcf)](_0x1152dd,_0x3c224b),_0x52e5f3={};for(const _0x4f6e07 in config[_0x5f3834(0xf5)][_0x5f3834(0xd5)]){const _0x2f4698=config[_0x5f3834(0xf5)]['Schedule'][_0x4f6e07],_0x3f9e5a=_0x2f4698['match'](_0x257cf8);if(_0x3f9e5a){if('cOSXE'!=='wSpJD'){const _0x27e5da=moment['tz'](_0xb07584+'\x20'+_0x3f9e5a[0x1],'YYYY-MM-DD\x20H:mm',config[_0x5f3834(0xf5)][_0x5f3834(0xcc)]),_0x53627d=moment['tz'](_0xb07584+'\x20'+_0x3f9e5a[0x2],_0x5f3834(0xc5),config['WorkingHours']['Timezone']);_0x52e5f3['{startTime-'+_0x4f6e07+'}']='<t:'+_0x27e5da['unix']()+':t>',_0x52e5f3['{endTime-'+_0x4f6e07+'}']='<t:'+_0x53627d['unix']()+':t>';}else{let _0x493382=new _0x2967c2()[_0x5f3834(0xfc)](_0x33a0c7['WorkingHours']['outsideWorkingHoursTitle'])[_0x5f3834(0xe8)](_0x5f3834(0xf9))['setDescription'](_0x3f9dea)[_0x5f3834(0xd4)]({'text':''+_0x20b6a4['user'][_0x5f3834(0x106)],'iconURL':''+_0x41795f[_0x5f3834(0x113)][_0x5f3834(0xd2)]({'format':_0x5f3834(0xce),'dynamic':!![],'size':0x400})})[_0x5f3834(0x10c)]();if(_0x130c43)_0x49c895[_0x5f3834(0xda)]({'embeds':[_0x493382]});}}else console[_0x5f3834(0xca)](_0x5f3834(0xbf),_0x5f3834(0x100)+_0x4f6e07+_0x5f3834(0x102));}let _0x2e920a=config[_0x5f3834(0xf5)][_0x5f3834(0xfa)];for(const [_0x253597,_0x2974c8]of Object['entries'](_0x52e5f3)){if('fwDyB'==='fwDyB')_0x2e920a=_0x2e920a['replace'](new RegExp(_0x253597,'g'),_0x2974c8);else{_0x54f09b['log'](_0x5f3834(0xbf),_0x5f3834(0x110)+_0x20a719+_0x5f3834(0xd3));return;}}_0x2e920a=_0x2e920a['replace'](/{startTime-currentDay}/g,_0x52e5f3['{startTime-'+_0x7ca04c+'}'])['replace'](/{endTime-currentDay}/g,_0x52e5f3[_0x5f3834(0xe4)+_0x7ca04c+'}']);if(!_0x4e9138){let _0x9d83f2=new EmbedBuilder()[_0x5f3834(0xfc)](config[_0x5f3834(0xf5)]['outsideWorkingHoursTitle'])[_0x5f3834(0xe8)]('Red')[_0x5f3834(0x10d)](_0x2e920a)[_0x5f3834(0xd4)]({'text':''+_0x5d22d8['user'][_0x5f3834(0x106)],'iconURL':''+_0x5d22d8[_0x5f3834(0x113)]['displayAvatarURL']({'format':_0x5f3834(0xce),'dynamic':!![],'size':0x400})})['setTimestamp']();if(_0x50823e)_0x50823e[_0x5f3834(0xda)]({'embeds':[_0x9d83f2]});}}else{const _0x58afed=_0x6cee02[_0x5f3834(0xf5)]['Schedule'][_0x3eff56],_0xada09b=_0x58afed[_0x5f3834(0xf1)](_0x337fac);if(_0xada09b){const _0x1ea09f=_0x543ad4['tz'](_0x3891d4+'\x20'+_0xada09b[0x1],'YYYY-MM-DD\x20H:mm',_0x4d2bd2['WorkingHours']['Timezone']),_0x5812de=_0x589d6d['tz'](_0x349fca+'\x20'+_0xada09b[0x2],'YYYY-MM-DD\x20H:mm',_0x1c27b1['WorkingHours']['Timezone']);_0x35aedc['{startTime-'+_0x723cfa+'}']=_0x5f3834(0xe0)+_0x1ea09f['unix']()+':t>',_0x5be3ab['{endTime-'+_0x110069+'}']=_0x5f3834(0xe0)+_0x5812de['unix']()+_0x5f3834(0xfb);}else _0x269b3f['log']('\x1b[31m%s\x1b[0m',_0x5f3834(0x100)+_0x450823+_0x5f3834(0x102));}}if(!_0x2934f4['questions']||_0x2934f4['questions'][_0x5f3834(0xf8)]===0x0)return;const _0x43b52b=config[_0x1461eb];if(!_0x43b52b){console['log'](_0x5f3834(0xde)+_0x1461eb);return;}if(_0x2934f4['questions']['length']!==_0x43b52b[_0x5f3834(0xc7)]['length']){if('bWher'==='zJWMV')return _0x490874[_0xf5e7a8['question']]=_0x212fd6[_0x5f3834(0x10a)]||_0x4bab16['Locale']['notAnswered'],_0x4078de;else{console['log'](_0x5f3834(0xf7));return;}}const _0x5e2ba7=_0x2934f4['questions'][_0x5f3834(0xfe)]((_0x920392,_0x516cbe)=>{const _0x4b7e69=_0x5f3834,_0xc9d59b=_0x43b52b[_0x4b7e69(0xc7)]['find'](_0x2fdc2b=>_0x2fdc2b['customId']===_0x920392['customId']);return!_0xc9d59b;});if(_0x5e2ba7){if('dvivP'!=='dvivP'){let _0x6e5692=_0x4d4ec1[_0x272ace[_0x5f3834(0xc6)]];if(!_0x6e5692)_0x6e5692=_0xcf471f['Locale'][_0x5f3834(0xee)];_0xfa755e[_0x5f3834(0xdf)]({'name':_0x280c5e[_0x5f3834(0xc6)],'value':_0x5f3834(0x10e)+_0x6e5692+_0x5f3834(0x10e)});}else{console['log'](_0x5f3834(0x108));return;}}const _0xaae279=_0x2934f4['questions'][_0x5f3834(0xc4)]((_0x35c54d,_0x319c2a)=>{const _0x31e5f5=_0x5f3834;return _0x35c54d[_0x319c2a['question']]=_0x319c2a['response']||config['Locale'][_0x31e5f5(0xee)],_0x35c54d;},{}),_0x2ab4a9=_0x2934f4[_0x5f3834(0xef)]['some'](_0xbbf77e=>!_0xaae279[_0x5f3834(0xe9)](_0xbbf77e[_0x5f3834(0xc6)]));if(_0x2ab4a9){if(_0x5f3834(0xd8)===_0x5f3834(0xf4)){_0x5f3eea[_0x5f3834(0xca)]('Questions\x20do\x20not\x20match\x20the\x20configured\x20questions.');return;}else{console['log']('Questions\x20do\x20not\x20match\x20the\x20configured\x20questions.');return;}}if(_0x2934f4&&_0x2934f4['msgID']){if('qiaDH'===_0x5f3834(0x107))try{const _0x4c7f26=await _0x50823e[_0x5f3834(0xe2)][_0x5f3834(0xc9)](_0x2934f4['msgID']);if(!_0x4c7f26){if('AZEZu'==='GuUHO'){const _0x114c25=_0x41ebd4['Questions'][_0x5f3834(0xc3)](_0x41e7d2=>_0x41e7d2['customId']===_0x35b7d3['customId']);return!_0x114c25;}else{console['log']('Ticket\x20message\x20not\x20found.');return;}}const _0x347d72=EmbedBuilder[_0x5f3834(0x105)](_0x4c7f26['embeds'][0x0]);_0x2934f4[_0x5f3834(0xef)]['forEach'](_0x1755e7=>{const _0x4872ed=_0x5f3834;let _0x127aa1=_0xaae279[_0x1755e7['question']];if(!_0x127aa1)_0x127aa1=config['Locale'][_0x4872ed(0xee)];_0x347d72['addFields']({'name':_0x1755e7[_0x4872ed(0xc6)],'value':'```'+_0x127aa1+_0x4872ed(0x10e)});}),await _0x4c7f26['edit']({'embeds':[_0x347d72]});}catch(_0x132686){console['log']('Error\x20fetching\x20or\x20editing\x20the\x20message:\x20'+_0x132686);}else{_0x1b1d95[_0x5f3834(0xca)]('\x1b[31m%s\x1b[0m','[ERROR]\x20Invalid\x20working\x20hours\x20configuration\x20for\x20'+_0x3ce446+'\x20(format).\x20Contact\x20support\x20and\x20provide\x20your\x20config.yml\x20file.');return;}}}else _0x344383[_0x5f3834(0xda)]({'embeds':[_0x4955f1]});}};